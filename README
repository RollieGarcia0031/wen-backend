THIS IS A REWRITTEN VERSION OF THE BACKEND with additional features